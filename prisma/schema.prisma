generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider     = "mysql"
    url          = env("DATABASE_URL")
    relationMode = "prisma"
}

model Message {
    id        String   @id @default(uuid())
    name      String
    email     String
    body      String
    createdAt DateTime @default(now())
}

model Employee {
    id            Int    @id @default(autoincrement())
    username      String
    password      String @db.Text
    contactNumber String
    position      String
    imgUrl        String @db.Text
    email         String
}

model CustomerInfo {
    id                   String   @id @default(uuid())
    dateOfBirth          DateTime
    defaultContactNumber String
    defaultAddress       String
    isBlocked            Boolean  @default(false)
}

enum Mode {
    WalkIn
    Online
}

enum PaymentStatus {
    Pending
    Fulfilled
}

model Order {
    id            Int           @id @default(autoincrement())
    mode          Mode
    createdAt     DateTime      @default(now())
    customerName  String
    paymentStatus PaymentStatus
    orderItems    OrderItem[]
    walkInOrders  WalkInOrder[]
    onlineOrders  OnlineOrder[]
}

model WalkInOrder {
    id           Int     @id
    paymentTotal Decimal
    name         String
    order        Order   @relation(fields: [id], references: [id])

    @@index([id])
}

model OnlineOrder {
    id             Int            @id
    customerId     String
    address        String
    contactNumber  String
    deliveryFee    Decimal
    deliveryStatus DeliveryStatus
    order          Order          @relation(fields: [id], references: [id])

    @@index([id])
}

enum DeliveryStatus {
    Pending
    Preparing
    OutForDelivery
    Received
    Cancelled
}

model Rate {
    id         Int      @id @default(autoincrement())
    rating     String
    review     String
    createdAt  DateTime @default(now())
    customerId String
}

model OrderItem {
    id         Int      @id @default(autoincrement())
    orderId    Int
    quantity   Int
    price      Decimal
    discount   Decimal
    menuItemId Int
    order      Order    @relation(fields: [orderId], references: [id])
    menuItem   MenuItem @relation(fields: [menuItemId], references: [id])

    @@index([orderId])
    @@index([menuItemId])
}

model MenuItem {
    id           Int            @id @default(autoincrement())
    name         String
    description  String         @db.VarChar(500)
    category     String
    price        Decimal
    isActive     Boolean
    orderItems   OrderItem[]
    imgUrl       String         @db.Text
    DiscountItem DiscountItem[]
}

model Reservation {
    id         String   @id @default(cuid())
    customerId String
    startAt    DateTime
    endAt      DateTime
    fee        Decimal
    guestCount Int
    createdAt  DateTime @default(now())
}

model Discount {
    id           Int            @id @default(autoincrement())
    endAt        DateTime
    startAt      DateTime
    amount       Decimal
    DiscountItem DiscountItem[]
}

model DiscountItem {
    id         Int      @id @default(autoincrement())
    discountId Int
    menuItemId Int
    discount   Discount @relation(fields: [discountId], references: [id])
    menuItem   MenuItem @relation(fields: [menuItemId], references: [id])

    @@index([discountId])
    @@index([menuItemId])
}

model Sales {
    id       Int      @id @default(autoincrement())
    price    Decimal
    quantity Int
    total    Decimal
    soldAt   DateTime
}

enum Status {
    Overstock
    Understock
    InBalance
}

model Equipment {
    id          Int     @id @default(autoincrement())
    name        String
    description String
    price       Decimal
    quantity    Int
    status      Status
}

model Supplier {
    id             Int             @id @default(autoincrement())
    name           String
    description    String
    contactNumber  String
    emailAddress   String
    address        String
    purchaseOrders PurchaseOrder[]
}

model PurchaseOrder {
    id                 Int                 @id @default(autoincrement())
    createdAt          DateTime            @default(now())
    supplierId         Int
    supplier           Supplier            @relation(fields: [supplierId], references: [id])
    purchaseOrderItems PurchaseOrderItem[]

    @@index([supplierId])
}

model PurchaseOrderItem {
    id              Int           @id @default(autoincrement())
    name            String
    quantity        Int
    purchaseOrderId Int
    purchaseOrder   PurchaseOrder @relation(fields: [purchaseOrderId], references: [id])

    @@index([purchaseOrderId])
}

model Ingredient {
    id                    Int                    @id @default(autoincrement())
    name                  String
    description           String
    price                 Decimal
    quantity              Int
    status                Status
    createdAt             DateTime               @default(now())
    updatedAt             DateTime               @updatedAt
    dailyReservationItems DailyReservationItem[]
}

model DailyReservation {
    id                    Int                    @id @default(autoincrement())
    name                  String
    description           String
    status                Status
    dailyReservationItems DailyReservationItem[]
}

model DailyReservationItem {
    id                 Int              @id @default(autoincrement())
    ingredientId       Int
    dailyReservationId Int
    quantity           Int
    ingredient         Ingredient       @relation(fields: [ingredientId], references: [id])
    dailyReservation   DailyReservation @relation(fields: [dailyReservationId], references: [id])

    @@index([ingredientId])
    @@index([dailyReservationId])
}
